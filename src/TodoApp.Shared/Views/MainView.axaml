<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:TodoApp.Shared.ViewModels"
             xmlns:local="using:TodoApp.Shared"
             xmlns:material="clr-namespace:Material.Icons.Avalonia;assembly=Material.Icons.Avalonia"
             x:Class="TodoApp.Shared.Views.MainView"
             x:DataType="vm:MainViewModel">

    <Panel>
        <Grid RowDefinitions="Auto,*" IsVisible="{Binding IsAuthenticated}">
            <Border Grid.Row="0" Background="{DynamicResource AppSurfaceBrush}" Padding="24,12" BoxShadow="0 2 8 0 #20000000">
                <Grid ColumnDefinitions="Auto,*,Auto,Auto,Auto,Auto">
                    <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="12" VerticalAlignment="Center">
                        <material:MaterialIcon Kind="CheckCircle" Width="28" Height="28"
                                               Foreground="{DynamicResource AccentBrush}" VerticalAlignment="Center"/>
                        <TextBlock Text="Sew's TODO" FontSize="18" FontWeight="Bold" Foreground="{DynamicResource AppTextBrush}" VerticalAlignment="Center"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="4" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Button Content="Dashboard" Command="{Binding NavigateToDashboardCommand}"
                                Padding="16,8" CornerRadius="8" FontWeight="Medium" FontSize="14">
                            <Button.Background>
                                <MultiBinding Converter="{StaticResource NavActiveMultiConverter}" ConverterParameter="Dashboard">
                                    <Binding Path="SelectedNav"/>
                                    <Binding Path="IsDarkTheme"/>
                                </MultiBinding>
                            </Button.Background>
                            <Button.Foreground>
                                <MultiBinding Converter="{StaticResource NavActiveForegroundConverter}" ConverterParameter="Dashboard">
                                    <Binding Path="SelectedNav"/>
                                    <Binding Path="IsDarkTheme"/>
                                </MultiBinding>
                            </Button.Foreground>
                        </Button>
                        <Button Content="Statistics" Command="{Binding NavigateToStatisticsCommand}"
                                Padding="16,8" CornerRadius="8" FontWeight="Medium" FontSize="14">
                            <Button.Background>
                                <MultiBinding Converter="{StaticResource NavActiveMultiConverter}" ConverterParameter="Statistics">
                                    <Binding Path="SelectedNav"/>
                                    <Binding Path="IsDarkTheme"/>
                                </MultiBinding>
                            </Button.Background>
                            <Button.Foreground>
                                <MultiBinding Converter="{StaticResource NavActiveForegroundConverter}" ConverterParameter="Statistics">
                                    <Binding Path="SelectedNav"/>
                                    <Binding Path="IsDarkTheme"/>
                                </MultiBinding>
                            </Button.Foreground>
                        </Button>
                    </StackPanel>

                    <Button Grid.Column="2"
                            Command="{Binding ToggleThemeCommand}"
                            Background="Transparent" Padding="8" VerticalAlignment="Center"
                            CornerRadius="8" Margin="0,0,8,0"
                            ToolTip.Tip="Toggle theme">
                        <material:MaterialIcon Kind="{Binding ThemeIconKind}" Width="22" Height="22"
                                               Foreground="{DynamicResource AppTextHintBrush}"/>
                    </Button>

                    <TextBlock Grid.Column="3" Text="Ctrl+N: New Task" Foreground="{DynamicResource AppTextCaptionBrush}"
                               FontSize="11" VerticalAlignment="Center" Margin="0,0,16,0"/>

                    <StackPanel Grid.Column="4" Orientation="Horizontal" Spacing="12" VerticalAlignment="Center" Margin="0,0,8,0">
                        <Border Background="{DynamicResource AccentBrush}" CornerRadius="20" Width="34" Height="34">
                            <TextBlock Text="{Binding CurrentUserInitial}" FontSize="14"
                                       Foreground="{DynamicResource AccentForegroundBrush}"
                                       HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="Bold"/>
                        </Border>
                        <TextBlock Text="{Binding CurrentUser}" Foreground="{DynamicResource AppTextSecondaryBrush}" VerticalAlignment="Center" FontSize="14"/>
                    </StackPanel>

                    <Button Grid.Column="5" Content="Logout" Command="{Binding LogoutCommand}"
                            Classes="danger" Padding="12,8"
                            CornerRadius="8" FontSize="13" FontWeight="Medium"/>
                </Grid>
            </Border>

            <Border Grid.Row="1" Background="{DynamicResource AppBackgroundBrush}">
                <ContentControl Content="{Binding CurrentView}">
                    <ContentControl.ContentTemplate>
                        <local:ViewLocator/>
                    </ContentControl.ContentTemplate>
                </ContentControl>
            </Border>
        </Grid>

        <ContentControl Content="{Binding CurrentView}" IsVisible="{Binding !IsAuthenticated}">
            <ContentControl.ContentTemplate>
                <local:ViewLocator/>
            </ContentControl.ContentTemplate>
        </ContentControl>

        <Border IsVisible="{Binding ShowNotification}"
                Background="{Binding NotificationColor}"
                CornerRadius="8" Padding="16,10"
                HorizontalAlignment="Center" VerticalAlignment="Bottom"
                Margin="0,0,0,24"
                BoxShadow="0 4 16 0 #40000000">
            <TextBlock Text="{Binding NotificationMessage}"
                       Foreground="White" FontSize="14" FontWeight="Medium"/>
        </Border>
    </Panel>
</UserControl>
